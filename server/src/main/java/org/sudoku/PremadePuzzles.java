package org.sudoku;

import java.util.Random;

/**
 * Storage for pre-made Sudoku puzzles with solutions.
 * Puzzles are stored in dot notation: '.' for empty cells, '1'-'9' for clues.
 */
public class PremadePuzzles {
    private static final Random random = new Random();

    public enum Difficulty {
        EASY, MEDIUM, HARD
    }

    /**
     * Holds a puzzle and its solution in string format
     */
    public static class PuzzleData {
        public final String puzzle;
        public final String solution;

        public PuzzleData(String puzzle, String solution) {
            this.puzzle = puzzle;
            this.solution = solution;
        }
    }

    /**
     * Result containing parsed puzzle and solution arrays
     */
    public static class ParsedPuzzle {
        public final int[] puzzle;
        public final int[] solution;

        public ParsedPuzzle(int[] puzzle, int[] solution) {
            this.puzzle = puzzle;
            this.solution = solution;
        }
    }

    // EASY Puzzles (more clues, easier to solve)
    private static final PuzzleData[] EASY_PUZZLES = {
        new PuzzleData("...7...9.....241.8..1........4..6...9..1..46..1.9......75..9..2.4.678.....84.....", "832761594769524138451893627584236719927185463316947285675319842243678951198452376"),
        new PuzzleData(".413......9....2..5.87.9..1.....21979.........2..1.5......4...5....7.42....1..3..", "241356978796481253538729641654832197917564832823917564369248715185673429472195386"),
        new PuzzleData("8..6...39...4.82...25........8........3.........7..4..9..86.75..4.37..8.3..2.9.4.", "874625139639418275125937864468592317793146528251783496912864753546371982387259641"),
        new PuzzleData("..9....4.8.14....776......12...19.8.......7....327.9..4....3..6937.....8.........", "359167842821495367764832591275319684198546723643278915482953176937621458516784239"),
        new PuzzleData(".31..92...........4..2...61..8..1.4.36......8.....69...2..5...98..4.....5...2.4..", "731869254256314897489275361978531642365942178142786935624153789813497526597628413"),
        new PuzzleData("..641.79...3...6..9..6..41...4.9....8.51...6.....6.......938.51...5......1.......", "256413798143789625978652413634895172895127364721364589467938251382571946519246837"),
        new PuzzleData(".......4..98.32..62...67..3....4........79...8.....9.5...3...2..67.28.5.......4.8", "736981542598432176241567893923645781615879234874213965189354627467128359352796418"),
        new PuzzleData("..35.48.2.1.6....9.........16.....5.....96.......8.3........2.3....63.98...2...14", "973514862514628739286937145168342957352796481497185326649851273721463598835279614"),
        new PuzzleData("..5.91......6....79..8.724.....15.2.8..97.41........6...958..74..2.69.5..........", "275491836148623597936857241694315728823976415751248369319582674482769153567134982"),
        new PuzzleData("2..5......3.8..5....679................47..368.526.4....9....42........85.2....7.", "298534167137826594456791283364918725921475836875263419689157342713642958542389671"),
        new PuzzleData("5.76.23...2......838..5........3.6.........5..38....7.7.25..........89.7..63...4.", "517682394629743518384951726975134682261879453438265179742596831153428967896317245"),
        new PuzzleData("2...9..15.9.....64..........2..15....45....976.....5..97.8.1.468..2.....4569.....", "267493815391578264584126973729615438145382697638749521972851346813264759456937182"),
        new PuzzleData(".98...51....7.94.......5..86............5..4.48.2..7.57.6..4.....9...1.2.......6.", "398642517165789423274315698652437981937158246481296735716824359849563172523971864"),
        new PuzzleData(".........14....6.9.8912..45.9..5.8.3...4.65.1...2...9...8....6.2.....1...65......", "357964218142875639689123745496751823823496571571238496918547362234689157765312984"),
        new PuzzleData(".3..1.24.8....4.39......8.......7.2...68......12...4...8...2.9...1.3.......4..67.", "639518247875264139124973865358147926946825713712396458487652391261739584593481672"),
        new PuzzleData(".4.6.15.....8...176..5.....1.........79..2.4..26.......14.78...5..1.....28...5...", "748621539352894617691537284135486792879352146426719853914278365567143928283965471"),
        new PuzzleData(".....2.57.7.35.98...47....379...48...8...56...2.9............3.64...........97...", "963842157172356984854719263795634821381275649426981375519468732647123598238597416"),
        new PuzzleData("....16........2...3........7.....6.8...9....4..48..9734..37...628.....3..9..24..7", "978516342145732869362489715719243658836957124524861973451378296287695431693124587"),
        new PuzzleData("..351948...2.8.9.1.......3.63.2.....8.1..........5...9........31..94.8...24......", "763519482452386971918472536635294718891637254247158369589721643176943825324865197"),
        new PuzzleData("2........457...2.......8...9.........8.1.2.6.7214...9..7...9.2...4..6.1.5....184.", "238654971457913286619278534946387152385192467721465398173849625894526713562731849")
    };

    // MEDIUM Puzzles (moderate clues)
    private static final PuzzleData[] MEDIUM_PUZZLES = {
        new PuzzleData("6...2..1...25....4..53...8..51.....2................9...4..1..32.3.49..1..8..6.2.", "647928315382517964195364287851693742729485136436172598964251873273849651518736429"),
        new PuzzleData("...8..67.....954...5..729..17.....6.94.5..7.852...8....1..........28........49...", "294813675387695421651472983178934562946521738523768194819356247465287319732149856"),
        new PuzzleData("3............619.5..8...6.....2.539182..39.6............27.....9..6..1.77....3.2.", "396857412274361985518942673467285391825139764139476258682714539953628147741593826"),
        new PuzzleData("..51.9.......4.....6....7.....52......1....2........46.5.6...7..764.1.3243.29....", "745169283813742965269835714384526197691374528527918346152683479976451832438297651"),
        new PuzzleData(".41.98..58.....7..3.54219................5.8....1....44.....3..1..532...5....9...", "641798235892356741375421968216984573734265189958173624469817352187532496523649817"),
        new PuzzleData("..9...8....4.......324.9...6.3..27....7...9...8...1.....6...4...7..8.3.9....932.1", "519267843764538192832419576643952718127846935985371624396125487271684359458793261"),
        new PuzzleData("..3..52........7...74..6.3....7....6..7.2.3...8......5.32...8...5.6..4.........9.", "193875264526934781874216539345798126967521348281463975632149857759682413418357692"),
        new PuzzleData("6381...........5..59..63.8.9..8.1.......54..1...9..8........9..8517.63.....5.8...", "638175429217489563594263187942831675783654291165927834476312958851796342329548716"),
        new PuzzleData("37...1...1..7942.......6...8.....4....2.3.......6....86.8.1...4493..7.1....2.....", "379521846186794235245386791867159423512438967934672158628915374493867512751243689"),
        new PuzzleData("..7.........1.6...46..79......8...7.3.19.7...6......4..1.6.....59.7....1..8.5.3..", "127485639839126754465379812954862173381947265672513948213694587596738421748251396"),
        new PuzzleData("...........3.2....21..7...9.54..7..23....6..1.9.43..5.1.....7.5.75.9.214.......9.", "547869123983521647216374589654187932328956471791432856139248765875693214462715398"),
        new PuzzleData("5........826.7....4....1...1...6...4..25...6....8.2.1...37.6......35..8.7.....65.", "531298476826475391479631528185967234942513867367842915253786149614359782798124653"),
        new PuzzleData("3.............2.......6..84..2..1.56.8....2...51....39..9.48..3.15.2..9.2...9....", "346815972198472365527369184472931856983756241651284739769148523815623497234597618"),
        new PuzzleData("35.........8.....564....27.7..6.9..28.....743.......9.......3.627...4.8..8.5.....", "357281964928467135641953278714639852869125743532748691495872316276314589183596427"),
        new PuzzleData(".......84......2..5..7....3384...71............2.1.4.6..76.5....1.....68.2.4..3..", "279136584863954271541728693384562719196347825752819436937685142415273968628491357"),
        new PuzzleData(".48.1.......5.4.....7....2......83.....7518.....2......7..45.8..3......99.582.41.", "548312796629574138317689524256498371493751862781236945172945683834167259965823417"),
        new PuzzleData("...5...8..........3.92...57..8.46.39.....92..6..3.57..2..67..9....9..82..6......3", "172563984856497312349218657728146539435789261691325748283671495517934826964852173"),
        new PuzzleData("..38.....2........165.......3.7..68.8.4.......7....24.42651.7..7....4....1827...5", "943825176287136954165497832532741689894362517671958243426513798759684321318279465"),
        new PuzzleData("...3.2.4.....1.35.4...7...9..5.4.9.....53..7...9..1...35..2.4........1..9.7.84...", "516392748798416352423875619175248963642539871839761524351927486284653197967184235"),
        new PuzzleData("7.9..24.........92......5..283....5..1..35..........79..2.9...7..5.4..8.4..2.8...", "759312468138456792624789513283974651917635824546821379862593147395147286471268935")
    };

    // HARD Puzzles (fewer clues, more challenging)
    private static final PuzzleData[] HARD_PUZZLES = {
        new PuzzleData(".4.1..........81.5..573...9......3....89..5...7.2.4.9.4......7.2.9........38.....", "842195736937468125165732489594687312628913547371254698486521973219376854753849261"),
        new PuzzleData("..92....8....9..45.41..396....6........5.1...9.8.......15.6.8......3.5.6.2.......", "569214378283796145741853962174689253632541789958327614315462897497138526826975431"),
        new PuzzleData("..1..8.2...5..786...91....33.6.9...5......31........8....71.6..9...5...2.6......8", "631548927425937861879162453386291745792485316514673289258719634943856172167324598"),
        new PuzzleData("..56971...........7..2.1.45.921.....6.89....4.4....7...2.4......1...6..79.......8", "435697182281345976769281345592174863678923514143568729827439651314856297956712438"),
        new PuzzleData(".....4..9..9.7.....8...347....4....2.462.78..81.....4.16.....8.......9.79..8..13.", "271684359439571628685923471793468512546217893812395746164739285358142967927856134"),
        new PuzzleData("612.8....84...5.....72.4....98...1.6...9..87.....4.5..5....7......1.9....71.2....", "612783945843695217957214368498572136125936874736841592589367421264159783371428659"),
        new PuzzleData("...4.....9....613.7..9...64..7...695.3.....7.586.........3.45.......5.1.8.5.9...6", "162437958948256137753918264217843695439562871586179423671324589394685712825791346"),
        new PuzzleData(".6..5.......78.5...3..9.8.2..........2.476.......28..3..82.5..734.............386", "867152439294783561135694872586319724923476158471528693618235947349867215752941386"),
        new PuzzleData(".9.........5.....1......8.46...5....53..6..1...891.3.6.128.....9......4.4.3..16.8", "894173265325684971167529834671352489539468712248917356712846593986235147453791628"),
        new PuzzleData("...8..53.3.......6....628.7.24....5....5..6......231..8.2...4.......7.....5.1.26.", "246879531387145926591362847924681753173594682658723194812936475469257318735418269"),
        new PuzzleData("7......864..1...57..835.2....5..312....5...7....714..3....78.....743.......2.....", "751942386432186957698357241975863124143529678826714593519678432267435819384291765"),
        new PuzzleData("8...2.7.1.2..........5.....2..7.41..1...8..2.45...9........1.46....572....8.4..9.", "895423761624178359731596482289764135167385924453219678572931846946857213318642597"),
        new PuzzleData("......97...2..........31....8.....3..491.2........84..6...7412.4......8712...6.9.", "863425971512769843974831256281647539349152768756398412638974125495213687127586394"),
        new PuzzleData(".....73......264.7.85......8.6.....2.5.4..17...1.8......8.1..36.6.2.....4........", "624957381139826457785341629876135942352469178941782563298514736567293814413678295"),
        new PuzzleData("....378..18.........6....59.5..46.73....91......8..9...1.......6.5..94....81.46..", "592637841184925736376418259859246173263791584741853962417562398625389417938174625"),
        new PuzzleData("..3......2..56..........3..8..4.57.3...8...15.4.6.....68.7..2...3...2.4..2..5.8.7", "953218674274563189168974352812495763396827415547631928685749231739182546421356897"),
        new PuzzleData("....6..12..539.64....47...33........2.9...1...5.....6...4..9....27..4...91.6..42.", "493865712175392648862471593346917285289536174751248369634729851527184936918653427"),
        new PuzzleData(".72..59..6..8.....9.86...2.......1.9.3......7......85.7....9.1.8..5.67.....78.3..", "372145986615892473948673521587264139134958267269317854753429618891536742426781395"),
        new PuzzleData(".7.2.3......19...2..8......98....4.6.2.....37...316......63....6....28..4....8..3", "579283641364195782218764395983527416126849537745316928897631254631452879452978163"),
        new PuzzleData("..369..5.5....2..89...5831.......29.......8.7.9......1....235..3.2...6...579.....", "183694752576132948924758316461387295235419867798265431619823574342571689857946123")
    };

    /**
     * Parse a dot-notation string into an int array
     * '.' becomes 0, '1'-'9' remain as their digit values
     */
    private static int[] parseString(String str) {
        if (str.length() != 81) {
            throw new IllegalArgumentException("Puzzle string must be exactly 81 characters");
        }
        
        int[] result = new int[81];
        for (int i = 0; i < 81; i++) {
            char c = str.charAt(i);
            if (c == '.') {
                result[i] = 0;
            } else if (c >= '1' && c <= '9') {
                result[i] = c - '0';
            } else {
                throw new IllegalArgumentException("Invalid character in puzzle string: " + c);
            }
        }
        return result;
    }

    /**
     * Get a random pre-made puzzle for the specified difficulty
     */
    public static ParsedPuzzle getRandomPuzzle(Difficulty difficulty) {
        PuzzleData[] puzzles;
        switch (difficulty) {
            case EASY:
                puzzles = EASY_PUZZLES;
                break;
            case MEDIUM:
                puzzles = MEDIUM_PUZZLES;
                break;
            case HARD:
                puzzles = HARD_PUZZLES;
                break;
            default:
                puzzles = EASY_PUZZLES;
        }

        PuzzleData selected = puzzles[random.nextInt(puzzles.length)];
        return new ParsedPuzzle(parseString(selected.puzzle), parseString(selected.solution));
    }

    /**
     * Get a specific puzzle by index (for testing)
     */
    public static ParsedPuzzle getPuzzle(Difficulty difficulty, int index) {
        PuzzleData[] puzzles;
        switch (difficulty) {
            case EASY:
                puzzles = EASY_PUZZLES;
                break;
            case MEDIUM:
                puzzles = MEDIUM_PUZZLES;
                break;
            case HARD:
                puzzles = HARD_PUZZLES;
                break;
            default:
                puzzles = EASY_PUZZLES;
        }

        if (index < 0 || index >= puzzles.length) {
            throw new IllegalArgumentException("Puzzle index out of bounds: " + index);
        }

        PuzzleData selected = puzzles[index];
        return new ParsedPuzzle(parseString(selected.puzzle), parseString(selected.solution));
    }
}
